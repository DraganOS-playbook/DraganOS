---
title: Final Tasks
description: Finalizing The DraganOS Playbook Installation
privilege: TrustedInstaller
actions:

- !writeStatus: {status: "Copying Files"}
- !run:
  exeDir: true
  exe: "Copy.bat"

- !writeStatus: {status: "Applying WallPaper"}
- !run: 
  exeDir: true
  exe: "WALLPAPER.bat"
  weight: 90

- !run:
  exeDir: true
  exe: "PowerShell"
  args: '-NoP -ExecutionPolicy Bypass -File SVCGROUP.ps1'
  weight: 50

- !writeStatus: {status: "Refreshing"}
- !taskKill: {name: "explorer", errorAction: Ignore}
- !taskKill: {name: "SearchApp", errorAction: Ignore}
- !taskKill: {name: "SearchHost", errorAction: Ignore}
- !taskKill: {name: "RuntimeBroker", errorAction: Ignore}
- !taskKill: {name: "TextInputHost", errorAction: Ignore}
- !taskKill: {name: "ShellExperienceHost", errorAction: Ignore}
- !taskKill: {name: "backgroundTaskHost", errorAction: Ignore}
- !taskKill: {name: "Widgets", errorAction: Ignore}

- !writeStatus: {status: "Removing logs"}
- !run:
  exeDir: true
  exe: "PowerShell"
  args: '-NoP -ExecutionPolicy Bypass -File CLEANER.ps1'
  weight: 150

- !writeStatus: {status: "Configuring Power Settings"}
- !run: 
  exeDir: true
  exe: "POW.bat"
  weight: 30

- !writeStatus: {status: "Installing Packages"}
- !run: 
  exeDir: true
  exe: "install.bat"
  weight: 100

- !writeStatus: {status: "Configuring StartMenu"}
- !run:
  exeDir: true
  exe: "STARTMENU.bat"
  weight: 100

- !writeStatus: {status: "Remove Onedrive"}
- !run:
  exeDir: true
  exe: "ONED.bat"
  weight: 50

- !writeStatus: {status: "Configuring Device Manager"}
- !run: 
  exeDir: true
  exe: "DEVMANVIEW.bat"

- !writeStatus: {status: "Disabling Defender"}
- !run:
  exeDir: true
  exe: "Defender.bat"
  weight: 40

- !writeStatus: {status: "Finalize"}
- !run: 
  exeDir: true
  exe: "FINALIZE.bat"
  weight: 150

# Necessary to refresh start menu entries etc.
- !appx: {operation: clearCache, name: '*Client.CBS*'}
- !appx: {operation: clearCache, name: '*StartMenuExperienceHost*'}
- !appx: {operation: clearCache, name: '*Windows.Search*'}
- !appx: {operation: clearCache, name: '*TCUI*'}
# Workaround for KGL versions to match
- !appx: {operation: clearCache, name: '*XboxGameCallableUI*'}
- !appx: {operation: clearCache, name: '*XboxGameOverlay*'}
- !appx: {operation: clearCache, name: '*XboxGamingOverlay*'}
- !appx: {operation: clearCache, name: '*XboxIdentityProvider*'}
- !appx: {operation: clearCache, name: '*XboxSpeechToTextOverlay*'}