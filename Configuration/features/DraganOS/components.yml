---
title: Components
description: Remove windows components and files
actions:
  - !writeStatus: {status: "Removing components"}
  - !taskKill: {name: "explorer"}
  - !taskKill: {name: "SecurityHealthHost"}
  - !taskKill: {name: "SecurityHealthService"}
  - !taskKill: {name: "SecurityHealthSystray"}
  - !taskKill: {name: "SkypeBackgroundHost"}

  - !file: {path: "%windir%\\System32\\smartscreen.exe"}
  - !file: {path: "%windir%\\System32\\smartscreenps.dll"}
  - !file: {path: "%windir%\\System32\\SecurityHealthSystray.exe"}
  - !file: {path: "%windir%\\System32\\SecurityHealthService.exe"}
  - !file: {path: "%windir%\\System32\\SecurityHealthAgent.dll"}
  - !file: {path: "%windir%\\System32\\SecurityHealthHost.exe"}
  - !file: {path: "%windir%\\System32\\SecurityHealthSSO.dll"}
  - !file: {path: "%windir%\\System32\\SecurityHealthCore.dll"}
  - !file: {path: "%windir%\\System32\\SecurityHealthProxyStub.dll"}
  - !file: {path: "%windir%\\System32\\SecurityHealthUdk.dll"}
  - !file: {path: "%ProgramW6432%\\Windows Defender", weight: 30}
  - !file: {path: "%ProgramData%\\Microsoft\\Windows Defender", weight: 30}
  - !file: {path: "%ProgramFiles(x86)%\\Windows Defender", weight: 30}
  - !file: {path: "%windir%\\System32\\drivers\\WdNisDrv.sys"}
  - !file: {path: "%ProgramW6432%\\Windows Defender Advanced Threat Protection"}
  - !file: {path: "%SystemDrive%\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection"}
  - !file: {path: "%windir%\\System32\\drivers\\cldflt.sys"}
  - !scheduledTask:
    path: "\\Microsoft\\Windows\\Windows Defender\\"
    operation: delete

    # Microsoft Edge
  - !taskKill: {name: "MicrosoftEdgeUpdate", ignoreErrors: true, option: "remove-edge"}
  - !taskKill: {name: "msedge", ignoreErrors: true, option: "remove-edge"}
  - !taskKill: {name: "MicrosoftEdge*", ignoreErrors: true, option: "remove-edge"}
  - !taskKill: {name: "setup", ignoreErrors: true, pathContains: "\\Edge", option: "remove-edge"}
  
  - !powerShell:
    command: '.\RemoveEdge.ps1 -Mode EdgeBrowser'
    exeDir: true
    runas: currentUserElevated
    option: "remove-edge"
    weight: 40

  - !file: {path: "%ProgramFiles(x86)%\\Microsoft\\Edge", option: "remove-edge", weight: 50}

  # Allow uninstall of Edge, EdgeUpdate and WebView
  - !registryValue: {path: 'HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft Edge', value: 'NoRemove', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft Edge Update', value: 'NoRemove', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft EdgeWebView', value: 'NoRemove', type: REG_DWORD, data: '0'}

    # OneDrive
  - !writeStatus: {status: "Removing OneDrive"}
  - !taskKill: {name: "OneDriveStandaloneUpdater", ignoreErrors: true}
  - !taskKill: {name: "OneDriveSetup", ignoreErrors: true}
  - !taskKill: {name: "OneDrive*", ignoreErrors: true}

  - !run: {exeDir: true, exe: "ONED.cmd", weight: 40}
  - !file: {path: "%SystemDrive%\\OneDriveTemp"}
  - !file: {path: "%ProgramData%\\Microsoft OneDrive"}

  # Clear caches of Client.CBS and more
  - !appx: {operation: clearCache, name: '*Windows.Search*'}
  - !appx: {operation: clearCache, name: '*Windows.SecHealthUI*'}
  # Necessary to refresh start menu entries etc.
  - !appx: {operation: clearCache, name: '*Client.CBS*'}
  - !appx: {operation: clearCache, name: '*TCUI*'}